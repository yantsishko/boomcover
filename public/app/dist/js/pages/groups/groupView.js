define(["app","marionette","backbone","underscore","text!templates/groups/group.ejs","text!templates/groups/groupShort.ejs","notify"],function(t,e,o,n,c,i,r){"use strict";return e.ItemView.extend({events:{"click [type=button]":"showGroupCover","click [data-action=unconnect-group]":"unconnectGroup"},modelEvents:{change:"render"},className:function(){return"main"===this.options.templateName?"":"group-avatar redactor-group-active"},initialize:function(){this.template="main"===this.options.templateName?n.template(c):n.template(i)},showGroupCover:function(e){this.model.get("connected")?window.location="/#constructor/"+this.model.id:o.$.ajax({async:!1,url:t.url+"/api/v1/group/authorize/"+this.model.id,success:function(t){window.location=t},error:function(t){o.$.notify("У Вас подключено максимальное количество групп для данного тарифа.","error")}})},unconnectGroup:function(e){var n=this;e.target.checked&&o.$.ajax({async:!1,method:"POST",url:t.url+"/api/v1/group/"+this.model.id+"/unconnect",success:function(t){o.$.notify("Группа отключена успешно","success"),n.model.set("connected",!1)}})}})});