define(["app","marionette","backbone","underscore","text!templates/widgets/image/index.ejs","bootstrapcolorpicker","datetimepicker","moment","notify","rangeslider"],function(e,i,t,n,o,a,r,s,l,c){"use strict";return i.ItemView.extend({template:n.template(o),events:{"change input[name=image_url]":"url","change input[name=image_size]":"size","click .image-sticker":"sticker"},initialize:function(e){},onRender:function(){this.setSliders()},onShow:function(){},uploadFile:function(i){if(i.size>3072e3)t.$.notify("Размер файла до 3х мб","warn");else{var n=window.URL||window.webkitURL,o=new Image;o.onload=function(){var n=new FormData;n.append("file",i),t.$.ajax({method:"POST",processData:!1,contentType:!1,data:n,url:e.url+"/api/v1/file",success:function(e){console.log(e)},error:function(e){t.$.notify("Произошла ошибка","error"),401==e.status&&(window.location="/login")}})},o.src=n.createObjectURL(i)}},url:function(e){this.model.set("file_url",e.target.value)},sticker:function(e){this.model.set("predifined_file",e.target.id)},setSliders:function(){var e=this;this.$el.find("#image_size").ionRangeSlider({type:"single",min:0,max:200,from:e.model.get("size"),step:1,postfix:" px",onChange:function(i){e.model.set("size",i.from)}})}})});